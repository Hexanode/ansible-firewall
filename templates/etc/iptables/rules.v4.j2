# Generated by Ansible Firewall role

# NAT
*nat
:PREROUTING ACCEPT [0:0]
:INPUT ACCEPT [0:0]
:OUTPUT ACCEPT [0:0]
:POSTROUTING ACCEPT [0:0]
COMMIT

# FILTER
*filter
:INPUT ACCEPT [0:0]
:FORWARD ACCEPT [0:0]
:OUTPUT ACCEPT [0:0]
:LOG_DROP - [0:0]
:LOG_DROP_OUT - [0:0]

# BEGIN RULES
-A INPUT -i lo -m comment --comment "00000 INPUT ALL ACCEPT lo" -j ACCEPT
-A INPUT -m comment --comment "00001 INPUT ALL RELATED,ESTABLISHED ACCEPT" -m state --state RELATED,ESTABLISHED -j ACCEPT
{% if firewall_allow_icmp %}
-A INPUT -p icmp -m comment --comment "00002 INPUT ICMP ACCEPT" -j ACCEPT
{% endif %}

# END RULES
{% if firewall_log_dropped_packets %}
-A INPUT -m comment --comment "99998 INPUT ALL LOG_DROP" -j LOG_DROP
-A INPUT -m comment --comment "99999 INPUT ALL DROP" -j DROP
{% elif firewall_reject_instead_of_drop %}
-A INPUT -j REJECT
{% else %}
-A INPUT -j DROP
{% endif %}

# DROP RULES
{% if firewall_log_dropped_packets %}
## LOG DROP INPUT
-A LOG_DROP -m limit --limit 10/minute -m comment --comment "00000 LOG_DROP ALL LOG" -j LOG --log-prefix "[IPT DROP]: "
-A LOG_DROP -m limit --limit 10/minute -m comment --comment "00001 LOG_DROP ALL DROP" -j DROP
## LOG DROP OUTPUT
-A LOG_DROP_OUT -m limit --limit 10/minute -m comment --comment "00000 LOG_DROP_OUT ALL LOG" -j LOG --log-prefix "[IPT DROP OUT]: "
-A LOG_DROP_OUT -m limit --limit 10/minute -m comment --comment "00001 LOG_DROP_OUT ALL DROP" -j DROP
{% endif %}

COMMIT
# Completed
